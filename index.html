<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Finance Pulse</title>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css">
</head>
<body class="bg-gray-900 text-white font-sans">
  <div class="max-w-4xl mx-auto p-4">
    <h1 class="text-3xl font-bold mb-4">üìä Finance Pulse</h1>

    <!-- Market Alerts -->
    <section id="alerts" class="mb-6">
      <h2 class="text-xl font-semibold mb-2">Market Pulse Alerts</h2>
      <div class="grid grid-cols-2 gap-4" id="alert-cards"></div>
    </section>

    <!-- News Headlines -->
    <section class="mb-6">
      <h2 class="text-xl font-semibold mb-2">Latest Market Headlines</h2>
      <ul id="news-list" class="list-disc list-inside text-sm space-y-1"></ul>
    </section>

    <!-- Macro Snapshot -->
    <section class="mb-6">
      <h2 class="text-xl font-semibold mb-2">Macro Snapshot</h2>
      <div id="macro-panel" class="grid grid-cols-2 gap-4 text-sm"></div>
    </section>

    <!-- Mode Suggestion -->
    <section class="mb-6">
      <h2 class="text-xl font-semibold mb-2">Investment Mode</h2>
      <div id="mode-box" class="p-4 rounded-lg font-bold text-lg text-center bg-yellow-500 text-black">Loading...</div>
    </section>
  </div>

  <script>
  const API_KEY = '146a9495d2c64e85936d21b0be82c103'; // replace this with your real key
  const symbols = [
    { name: 'S&P 500', symbol: 'SPY', type: 'etf' },
    { name: 'VIX', symbol: 'VIX', type: 'index' },
    { name: 'Bitcoin', symbol: 'BTC/USD', type: 'crypto' },
  ];

  async function fetchPrices() {
    const base = 'https://api.twelvedata.com/price';
    const data = [];

    for (const s of symbols) {
      const url = `${base}?symbol=${encodeURIComponent(s.symbol)}&apikey=${API_KEY}`;
      try {
        const res = await fetch(url);
        const json = await res.json();
        data.push({ ...s, value: parseFloat(json.price) });
      } catch (err) {
        console.error(`Error fetching ${s.symbol}:`, err);
      }
    }

    return data;
  }

  function determineRiskType(name, value) {
    if (name === 'S&P 500' && value < 430) return 'risk-off';
    if (name === 'VIX' && value > 20) return 'risk-off';
    if (name === 'Bitcoin' && value < 30000) return 'risk-off';
    return 'neutral';
  }

  function renderLiveAlerts(data) {
    const container = document.getElementById('alert-cards');
    container.innerHTML = '';
    data.forEach(a => {
      const riskType = determineRiskType(a.name, a.value);
      const bg = riskType === 'risk-off' ? 'bg-red-500' :
                 riskType === 'risk-on' ? 'bg-green-500' : 'bg-yellow-500';
      container.innerHTML += `<div class="p-4 rounded-lg ${bg} text-black">
        <div class="text-sm font-bold">${a.name}</div>
        <div class="text-xl">${a.value.toLocaleString()}</div>
      </div>`;
    });

    renderModeSuggestion(data);
  }

  function renderModeSuggestion(alerts) {
    const modeBox = document.getElementById('mode-box');
    const riskOffCount = alerts.filter(a => determineRiskType(a.name, a.value) === 'risk-off').length;
    if (riskOffCount >= 2) {
      modeBox.textContent = '‚ö†Ô∏è Caution: Consider Holding Cash or Rebalancing';
      modeBox.className = 'p-4 rounded-lg font-bold text-lg text-center bg-red-500 text-black';
    } else if (riskOffCount === 0) {
      modeBox.textContent = '‚úÖ Market Stable: Stay Invested';
      modeBox.className = 'p-4 rounded-lg font-bold text-lg text-center bg-green-500 text-black';
    } else {
      modeBox.textContent = 'üü° Neutral: Stay Informed';
      modeBox.className = 'p-4 rounded-lg font-bold text-lg text-center bg-yellow-500 text-black';
    }
  }

  async function initDashboard() {
    const priceData = await fetchPrices();
    renderLiveAlerts(priceData);
  }

  initDashboard();
</script>

</body>
</html>
